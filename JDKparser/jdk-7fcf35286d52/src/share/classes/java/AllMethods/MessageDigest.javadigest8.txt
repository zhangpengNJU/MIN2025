/**
 * Completes the hash computation by performing final operations
 * such as padding. The digest is reset after this call is made.
 *
 * @return the array of bytes for the resulting hash value.
 */
public byte[] digest() {
    /* Resetting is the responsibility of implementors. */
    byte[] result = engineDigest();
    state = INITIAL;
    return result;
}