final void advance() {
    if (next == null)
        throw new NoSuchElementException();
    lastReturned = next;
    if (isDescending)
        descend();
    else
        ascend();
}