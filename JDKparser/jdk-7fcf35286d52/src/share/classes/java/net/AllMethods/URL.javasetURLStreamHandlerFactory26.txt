/**
 *  Sets an application's {@code URLStreamHandlerFactory}.
 *  This method can be called at most once in a given Java Virtual
 *  Machine.
 *
 * <p> The {@code URLStreamHandlerFactory} instance is used to
 * construct a stream protocol handler from a protocol name.
 *
 *  <p> If there is a security manager, this method first calls
 *  the security manager's {@code checkSetFactory} method
 *  to ensure the operation is allowed.
 *  This could result in a SecurityException.
 *
 *  @param      fac   the desired factory.
 *  @exception  Error  if the application has already set a factory.
 *  @exception  SecurityException  if a security manager exists and its
 *              {@code checkSetFactory} method doesn't allow
 *              the operation.
 *  @see        java.net.URL#URL(java.lang.String, java.lang.String,
 *              int, java.lang.String)
 *  @see        java.net.URLStreamHandlerFactory
 *  @see        SecurityManager#checkSetFactory
 */
public static void setURLStreamHandlerFactory(URLStreamHandlerFactory fac) {
    synchronized (streamHandlerLock) {
        if (factory != null) {
            throw new Error("factory already defined");
        }
        SecurityManager security = System.getSecurityManager();
        if (security != null) {
            security.checkSetFactory();
        }
        handlers.clear();
        factory = fac;
    }
}